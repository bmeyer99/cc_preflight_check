# Task Status Template (DO NOT DELETE THIS)

## Task Identification
- **Task #**: P1-T1.3
- **Task Title**: Update `RESOURCE_ACTION_MAP` for Cortex XDR CFT
- **Task Assigned to**: Code Mode
- **Task Assigned from**: Architect Mode (Task 1.1.1)
- **Task Priority**: High
- **Task Status**: Assigned

## Task Details
### Requirements:
- Update the `RESOURCE_ACTION_MAP` data structure within the existing Python script.
- Incorporate accurate `generic_actions` for resource types found in the Cortex XDR CFT, based on the findings from Task P1-T1.2.
- Include more precise `arn_patterns` where possible for these resources, even if some placeholders must remain.
- Add detailed `property_actions` that map specific properties of resources in the [`connectors_aws_cf-d33f925f6195475daf212fdc8b1919e2-1747407759.yml`](connectors_aws_cf-d33f925f6195475daf212fdc8b1919e2-1747407759.yml) to their required IAM actions, as identified in Task P1-T1.2.
- Add specific tagging actions (e.g., `iam:TagRole`, `s3:PutBucketTagging`, `lambda:TagResource`) for each relevant resource type in the Cortex XDR CFT.
- The update should specifically focus on, but not be limited to, the following resource types from the Cortex XDR CFT: `AWS::IAM::Role` (including inline policies, managed policies, assume role documents), `AWS::S3::Bucket` (including encryption, lifecycle, policy sub-resource), `AWS::KMS::Key` (including key policy), `AWS::CloudTrail::Trail` (including S3 bucket interactions, KMS key interactions, CWL interactions if applicable), `AWS::Lambda::Function` (including `iam:PassRole`), `AWS::SQS::Queue`, `AWS::SNS::Topic`, `AWS::SNS::Subscription`.

### Acceptance Criteria (AC):
- The `RESOURCE_ACTION_MAP` in the Python script is verifiably updated to reflect the identified `generic_actions` for all relevant resources in the Cortex XDR CFT.
- The `RESOURCE_ACTION_MAP` includes improved and more precise `arn_patterns` for resources within the Cortex XDR CFT.
- The `RESOURCE_ACTION_MAP` contains comprehensive `property_actions` that accurately map the properties of Cortex XDR CFT resources to their specific IAM actions.
- The `RESOURCE_ACTION_MAP` includes specific tagging actions for all taggable resource types present in the Cortex XDR CFT.
- The updates to `RESOURCE_ACTION_MAP` demonstrably cover all specified focus resource types from the Cortex XDR CFT as listed in the requirements.

## Planning & Tracking
- **Task Dependencies**: P1-T1.2

## Documentation
### Task Outcome & Summary
[To be filled upon completion]

### Task Issues & Blockers
- [To be filled if any arise]

### Associated Files
- [`project_plan.md`](project_plan.md)
- [`connectors_aws_cf-d33f925f6195475daf212fdc8b1919e2-1747407759.yml`](connectors_aws_cf-d33f925f6195475daf212fdc8b1919e2-1747407759.yml)
- [`tasks/task_template.md`](tasks/task_template.md)
- Existing Python script containing `RESOURCE_ACTION_MAP` (e.g., [`cc_preflight.py`](cc_preflight.py))
- Output/documentation from Task P1-T1.2